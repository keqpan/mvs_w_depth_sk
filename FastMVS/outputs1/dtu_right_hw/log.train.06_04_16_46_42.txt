2020-06-04 16:46:42,022 fastmvsnet INFO: Using 1 GPUs
2020-06-04 16:46:42,022 fastmvsnet INFO: Namespace(config_file='configs/dtu_right_hw.yaml', opts=[])
2020-06-04 16:46:42,022 fastmvsnet INFO: Loaded configuration file configs/dtu_right_hw.yaml
2020-06-04 16:46:42,022 fastmvsnet INFO: Running with config:
AUTO_RESUME: True
DATA:
  NUM_WORKERS: 16
  TEST:
    IMG_HEIGHT: 960
    IMG_WIDTH: 1280
    INTER_SCALE: 2.13
    NUM_VIEW: 5
    NUM_VIRTUAL_PLANE: 96
    ROOT_DIR: data/dtu
  TRAIN:
    INTER_SCALE: 4.24
    NUM_VIEW: 3
    NUM_VIRTUAL_PLANE: 48
    ROOT_DIR: data/dtu
  VAL:
    NUM_VIEW: 3
    ROOT_DIR: data/dtu
MODEL:
  EDGE_CHANNELS: (32, 32, 64)
  FLOW_CHANNELS: (64, 64, 16, 1)
  IMG_BASE_CHANNELS: 8
  NUM_VIRTUAL_PLANE: 48
  TEST:
    IMG_SCALES: (0.25, 0.5)
    INTER_SCALES: (0.75, 0.15)
  TRAIN:
    IMG_SCALES: (0.25, 0.5)
    INTER_SCALES: (0.75, 0.375)
  VAL:
    IMG_SCALES: (0.125, 0.25)
    INTER_SCALES: (0.75, 0.375)
  VALID_THRESHOLD: 8.0
  VOL_BASE_CHANNELS: 8
  WEIGHT: 
OUTPUT_DIR: @
RNG_SEED: 1
SCHEDULER:
  INIT_EPOCH: 4
  MAX_EPOCH: 16
  MultiStepLR:
    gamma: 0.1
    milestones: ()
  StepLR:
    gamma: 0.9
    step_size: 2
  TYPE: StepLR
SOLVER:
  BASE_LR: 0.0005
  RMSprop:
    alpha: 0.9
  SGD:
    momentum: 0.9
  TYPE: RMSprop
  WEIGHT_DECAY: 0.001
TEST:
  AUGMENTATION: ()
  BATCH_SIZE: 1
  LOG_PERIOD: 10
  WEIGHT: outputs/dtu_wde3/model_016.pth
TRAIN:
  AUGMENTATION: ()
  BATCH_SIZE: 4
  CHECKPOINT_PERIOD: 1
  FROZEN_PATTERNS: ()
  LOG_PERIOD: 10
  VAL_METRIC: <1_cor
  VAL_PERIOD: 1
2020-06-04 16:46:42,035 fastmvsnet.trainer INFO: Build model:
FastMVSNet(
  (feature_fetcher): FeatureFetcher()
  (feature_grad_fetcher): FeatureGradFetcher()
  (point_grad_fetcher): PointGrad()
  (coarse_img_conv): ImageConv(
    (conv0): Sequential(
      (0): Conv2d(
        (conv): Conv2d(4, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): Conv2d(
        (conv): Conv2d(8, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (conv1): Sequential(
      (0): Conv2d(
        (conv): Conv2d(8, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2), bias=False)
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): Conv2d(
        (conv): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): Conv2d(
        (conv): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (conv2): Sequential(
      (0): Conv2d(
        (conv): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2), bias=False)
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): Conv2d(
        (conv): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (coarse_vol_conv): VolumeConv(
    (conv1_0): Conv3d(
      (conv): Conv3d(32, 16, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)
      (bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (conv2_0): Conv3d(
      (conv): Conv3d(16, 32, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)
      (bn): BatchNorm3d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (conv3_0): Conv3d(
      (conv): Conv3d(32, 64, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)
      (bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (conv0_1): Conv3d(
      (conv): Conv3d(32, 8, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
      (bn): BatchNorm3d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (conv1_1): Conv3d(
      (conv): Conv3d(16, 16, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
      (bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (conv2_1): Conv3d(
      (conv): Conv3d(32, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
      (bn): BatchNorm3d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (conv3_1): Conv3d(
      (conv): Conv3d(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
      (bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (conv4_0): Deconv3d(
      (conv): ConvTranspose3d(64, 32, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), output_padding=(1, 1, 1), bias=False)
      (bn): BatchNorm3d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (conv5_0): Deconv3d(
      (conv): ConvTranspose3d(32, 16, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), output_padding=(1, 1, 1), bias=False)
      (bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (conv6_0): Deconv3d(
      (conv): ConvTranspose3d(16, 8, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), output_padding=(1, 1, 1), bias=False)
      (bn): BatchNorm3d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (conv6_2): Conv3d(8, 1, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
  )
  (propagation_net): PropagationNet(
    (img_conv): ImageConv(
      (conv0): Sequential(
        (0): Conv2d(
          (conv): Conv2d(4, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): Conv2d(
          (conv): Conv2d(8, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (conv1): Sequential(
        (0): Conv2d(
          (conv): Conv2d(8, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2), bias=False)
          (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): Conv2d(
          (conv): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (2): Conv2d(
          (conv): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (conv2): Sequential(
        (0): Conv2d(
          (conv): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2), bias=False)
          (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): Conv2d(
          (conv): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      )
    )
    (conv1): Sequential(
      (0): Conv2d(
        (conv): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): Conv2d(
        (conv): Conv2d(32, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (conv2): Sequential(
      (0): Conv2d(
        (conv): Conv2d(32, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): Conv2d(
        (conv): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (conv3): Sequential(
      (0): Conv2d(
        (conv): Conv2d(32, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): Conv2d(16, 9, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (unfold): Unfold(kernel_size=(3, 3), dilation=1, padding=0, stride=1)
  )
  (flow_img_conv): ImageConv(
    (conv0): Sequential(
      (0): Conv2d(
        (conv): Conv2d(4, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): Conv2d(
        (conv): Conv2d(8, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (conv1): Sequential(
      (0): Conv2d(
        (conv): Conv2d(8, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2), bias=False)
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): Conv2d(
        (conv): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): Conv2d(
        (conv): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (conv2): Sequential(
      (0): Conv2d(
        (conv): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2), bias=False)
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): Conv2d(
        (conv): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
)
2020-06-04 16:46:43,847 fastmvsnet.trainer INFO: No checkpoint found. Initializing model from scratch
2020-06-04 16:46:44,299 fastmvsnet.trainer INFO: Start training from epoch 0
2020-06-04 16:46:45,614 fastmvsnet.train INFO: EPOCH:  0  iter:    0  loss: 26.3671 (26.3671)  coarse_loss: 26.3671 (26.3671)  <1_pct_cor: 0.0747 (0.0747)  <3_pct_cor: 0.2500 (0.2500)  time: 1.3131 (1.3131)  data: 0.7047 (0.7047)  lr: 5.00e-04  max mem: 3076
2020-06-04 16:46:50,185 fastmvsnet.train INFO: EPOCH:  0  iter:   10  loss: 22.9063 (22.9063)  coarse_loss: 22.9063 (22.9063)  <1_pct_cor: 0.1253 (0.1253)  <3_pct_cor: 0.3374 (0.3374)  time: 0.5350 (0.5350)  data: 0.1514 (0.1514)  lr: 5.00e-04  max mem: 3077
2020-06-04 16:46:54,119 fastmvsnet.train INFO: EPOCH:  0  iter:   20  loss: 18.9170 (19.2717)  coarse_loss: 18.9170 (19.2717)  <1_pct_cor: 0.1840 (0.1788)  <3_pct_cor: 0.4553 (0.4456)  time: 0.4253 (0.4676)  data: 0.0654 (0.0959)  lr: 5.00e-04  max mem: 3077
2020-06-04 16:46:58,086 fastmvsnet.train INFO: EPOCH:  0  iter:   30  loss: 12.6618 (16.2969)  coarse_loss: 12.6618 (16.2969)  <1_pct_cor: 0.3183 (0.2498)  <3_pct_cor: 0.6568 (0.5435)  time: 0.3950 (0.4447)  data: 0.0346 (0.0760)  lr: 5.00e-04  max mem: 3077
2020-06-04 16:47:02,040 fastmvsnet.train INFO: EPOCH:  0  iter:   40  loss: 10.3060 (14.8982)  coarse_loss: 10.3060 (14.8982)  <1_pct_cor: 0.3859 (0.2798)  <3_pct_cor: 0.7386 (0.5885)  time: 0.3960 (0.4327)  data: 0.0346 (0.0660)  lr: 5.00e-04  max mem: 3077
2020-06-04 16:47:06,002 fastmvsnet.train INFO: EPOCH:  0  iter:   50  loss: 10.4407 (14.0004)  coarse_loss: 10.4407 (14.0004)  <1_pct_cor: 0.3847 (0.3027)  <3_pct_cor: 0.7265 (0.6153)  time: 0.3958 (0.4255)  data: 0.0349 (0.0599)  lr: 5.00e-04  max mem: 3077
2020-06-04 16:47:09,982 fastmvsnet.train INFO: EPOCH:  0  iter:   60  loss: 9.5047 (13.1298)  coarse_loss: 9.5047 (13.1298)  <1_pct_cor: 0.4246 (0.3273)  <3_pct_cor: 0.7495 (0.6413)  time: 0.3971 (0.4210)  data: 0.0353 (0.0559)  lr: 5.00e-04  max mem: 3077
2020-06-04 16:47:14,038 fastmvsnet.train INFO: EPOCH:  0  iter:   70  loss: 8.6077 (12.4813)  coarse_loss: 8.6077 (12.4813)  <1_pct_cor: 0.4620 (0.3476)  <3_pct_cor: 0.7822 (0.6623)  time: 0.4018 (0.4188)  data: 0.0353 (0.0529)  lr: 5.00e-04  max mem: 3077
2020-06-04 16:47:18,085 fastmvsnet.train INFO: EPOCH:  0  iter:   80  loss: 7.8469 (11.8254)  coarse_loss: 7.8469 (11.8254)  <1_pct_cor: 0.4961 (0.3690)  <3_pct_cor: 0.8057 (0.6819)  time: 0.4051 (0.4171)  data: 0.0352 (0.0508)  lr: 5.00e-04  max mem: 3077
2020-06-04 16:47:22,098 fastmvsnet.train INFO: EPOCH:  0  iter:   90  loss: 7.3873 (11.3617)  coarse_loss: 7.3873 (11.3617)  <1_pct_cor: 0.5196 (0.3854)  <3_pct_cor: 0.8247 (0.6980)  time: 0.4030 (0.4154)  data: 0.0354 (0.0491)  lr: 5.00e-04  max mem: 3077
